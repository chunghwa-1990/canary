<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.canary.sys.mapper.UserRoleMapper">


    <insert id="batchInsert" parameterType="java.util.List">
        INSERT INTO sys_user_role (id, user_id, role_id)
        VALUES
        <foreach collection="list" item="item" separator=",">
            (REPLACE(UUID(), '-', ''), #{item.userId}, #{item.roleId})
        </foreach>
    </insert>

    <select id="selectRoleByUserId" resultType="com.example.canary.sys.entity.RolePO">
        SELECT DISTINCT
            r.*
        FROM
            sys_role r
                INNER JOIN sys_user_role ur ON r.id = ur.role_id
                AND ur.is_deleted = '0'
        WHERE
            r.is_deleted = '0'
          AND r.is_disabled = 0
          AND ur.user_id = #{userId}
    </select>


</mapper>

